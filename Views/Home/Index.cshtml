@using UIConfiguration.Models
@using UIConfiguration.Utils
@model List<User>
@{
    ViewBag.Title = "Smart Mirror Login";
    ColorGenerator colorGen = new ColorGenerator();
}

<div id="user-selection">
    <div class="row">
        <div class="col-md-12">
            <h2>Select User</h2>
            <div class="row">
                @foreach (User u in Model)
                {
                    <div class="col-md-2">
                        <div class="userbox">
                            <input type="hidden" name="userObj" value="@Json.Serialize(u)" />
                            <div class="user-thumbnail">
                                <div class="thumbnailImage" id="thumbnail" style="background-color: @colorGen.getColor( @u.Name.ToUpper().First())">
                                    @if (!u.Thumbnail.Equals(String.Empty))
                                    {
                                        <img src="@u.Thumbnail" alt="Image" />
                                    }
                                    else
                                    {
                                        @u.Name.ToUpper().First()
                                    }
                                </div>
                            </div>
                            <div class="username" id="username">
                                @u.Name
                            </div>
                        </div>
                    </div>
                }
                <div class="col-md-2">
                    <div class="userbox" id="registration-box">
                        <div class="user-thumbnail">
                            <div class="thumbnailImage" id="thumbnail" style="color: #fff">
                                <span><i class="fa fa-plus"></i></span>
                            </div>
                        </div>
                        <div class="username" id="username">
                            <span>New User</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- login -->
<div id="user-login" class="row">
    <div class="col-md-12">
        <form method="post" id="login-form">
            <div class="col-md-2">
                <div class="userbox" id="login-userbox">
                </div>
            </div>
            <div class="col-md-10 form-group">
                <input type="password" name="password" class="form-control" placeholder="Password" required />
                <button type="button" class="btn btn-default btnBack">Cancel</button>
                <input type="submit" class="btn btn-primary">Login</input>
            </div>
        </form>
    </div>
</div>

<!-- registration -->
<div id="user-registration">
    <div class="row">
        <div class="col-md-12">
            <h2>Registration</h2>
            <form id="registration-form" action="/Account/CreateUser" method="post">
                <em>*</em><input type="text" class="form-control" name="username" placeholder="Username" required />
                <em>*</em><input type="password" class="form-control" name="password" placeholder="Password" required />
                <em>*</em><input type="password" class="form-control" name="passwordConfirm" placeholder="Confirm Password" required />
                <input type="file" name="thumbnail" />
                <button type="button" id="btnRecord" style="border-radius: 30px;" class="btn btn-primary"><i style="color: white;" class="fa fa-microphone fa-3x"></i></button><br />
                <input type="text" id="speechId" name="speechId" readonly placeholder="Record for getting an ID" />
                <em>*</em><input type="text" class="form-control" name="email" id="email" placeholder="E-Mail" required /><br />
                @*<input type="checkbox" id="newsletter" name="newsletter" checked /><label for="newsletter">Newsletter</label><br />*@
                <button type="button" class="btn btn-default btnBack">Cancel</button>
                <button type="reset" class="btn btn-default">Clear</button>
                <input type="submit" id="register-submit" class="btn btn-primary" value="Register"/>
            </form>
        </div>
    </div>
</div>
<!---->
@section Scripts{
    <script>
        $(document).ready(function () {
            $("#user-login").hide();
            $("#user-registration").hide();
                    });

        $(".userbox").on("click", function () {
            $("#login-userbox").html($(this).html());
            $("#user-login").toggle();
            $("#user-selection").toggle();
                    });

        $(".btnBack").on("click", function () {
            // leert alle inputs
            //$("input").val("");
            $("#user-login").hide();
            $("#user-selection").show();
            $("#user-registration").hide();
                    });

        $("#registration-box").on("click", function () {
            $("#user-login").hide();
            $("#user-selection").hide();
            $("#user-registration").show();
                    });

        $("#btnRecord").on("click", function () {
                        var recordClass = "record-active";
                        if ($("#btnRecord").hasClass(recordClass)) {
                $("#btnRecord").removeClass(recordClass);
                        } else {
                $("#btnRecord").addClass(recordClass);
                        }
                    });

        $("#login-form").submit(function(e) {
                        var url = "@Url.Action("Login", "Account")";

            $.ajax({
                            type: "POST",
                url: url,
                data: $("#login-form").serialize(),
                success: function (data) {
                                alert(data);
                            }
                        });
                        e.preventDefault();
                    });

        $("#registration-form").submit(function (e) {
            var f = $("#registration-form");
            var url = f.attr("action");
            var formData = f.serialize();
            console.log(formData);
            $.post(url, formData, function (data) {
                console.log(data);
            });

            return false;
            e.preventDefault();
        });
    </script>
}